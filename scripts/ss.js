var SS=(typeof SS!="undefined")?SS:{version:"0.2.6",mode:"compatibility",Router:function(h,e){if(!(this instanceof SS.Router)){return new SS.Router(h,e)}var l=this,c=false,a={},k;this.retired=[];this.routes=h;function d(){var m=document.location.hash;if(m[1]=="/"){m=m.substr(1,m.length)}return m.slice(1,m.length).split("/")}function g(o,n,m){if(!o){return false}if(Object.prototype.toString.call(o)!=="[object Array]"){o=[o]}for(var p=0;p<o.length;p++){if(!l.retired[o[p]]){if(e&&typeof o[p]=="string"){e[o[p]].apply(e,m)}else{if(typeof o[p]!="string"){o[p].apply(null,m)}else{throw new Error("exec: method not found on route '"+n+"'.")}}}}}function f(m,o,n){var p=m[o];if(typeof p==="string"||!!(p&&p.constructor&&p.call&&p.apply)){g(p,o,n)}if(p.once===true){l.retired[o]=true}else{if(p.once){g(p.once,o,n);delete p.once}}if(p.on){g(p.on,o,n)}k=p.onleave||null}function j(m,n){v=document.location.hash;v=v.slice(1);b(m,n,v,0)}function b(w,t,q,m){if(t[0]!=="/"){return}var p=m===0?"^\\/":"",n=new RegExp(p+t.slice(1)+"(.*)?").exec(q);if(n&&n.length>0&&!l.retired[t]){if(w[t].state){l.state=w[t].state}var u=n.slice(1),o=u.pop();f(w,t,u);if(typeof o==="string"&&o.length>0){for(var r in w[t]){if(w[t].hasOwnProperty(r)){if(r.indexOf("/")===0){b(w[t],r,o,++m)}}}}}}function i(o){var m=l.routes;if(o&&o.state){a=o.state}if(m.before){g(m.before.on||m.before)}if(m.leave&&!c){g(m.leave.on||m.leave)}if(m.once){g(m.once);delete m.once}if(l.leave){g(l.leave);l.onleave=null}for(var n in m){if(m.hasOwnProperty(n)){j(m,n)}}if(m.after){g(m.after.on||m.after)}}c=false;this.init=function(){SS.listener.init(i);i();return this};this.getState=function(){return l.state};this.getRetired=function(){return l.retired};this.getRoute=function(m){if(typeof m=="number"){return d()[m]}else{if(typeof m=="string"){var n=d();return n.indexOf(m)}else{return d()}}};this.setRoute=function(o,m,p){var n=d();if(typeof o==="number"&&typeof m==="string"){n[o]=m}else{if(typeof p==="string"){n.splice(o,m,s)}else{n=[o]}}SS.listener.setHash(n.join("/"));return n};return this},listener:{hash:document.location.hash,check:function(){var a=document.location.hash;if(a!=this.hash){this.hash=a;this.onHashChanged()}},fire:function(){if(SS.mode=="compatibility"){window.onhashchange()}else{this.onHashChanged()}},init:function(b){var a=this;if("onhashchange" in window&&(document.documentMode===undefined||document.documentMode>7)){window.onhashchange=b;SS.mode="compatibility"}else{var c=document.createElement("iframe");c.id="state-frame";c.style.display="none";document.body.appendChild(c);this.writeFrame("");if("onpropertychange" in document&&"attachEvent" in document){document.attachEvent("onpropertychange",function(){if(event.propertyName=="location"){a.check()}})}this.onHashChanged=b;window.setInterval(function(){a.check()},50);SS.mode="legacy"}return SS.mode},setHash:function(a){if(SS.mode=="legacy"){this.writeFrame(a)}document.location.hash=(a[0]==="/")?a:"/"+a;return this},writeFrame:function(a){var b=document.getElementById("state-frame");var c=b.contentDocument||b.contentWindow.document;c.open();c.write("<script>window._hash = '"+a+"'; window.onload = parent.listener.syncHash;<\/script>");c.close()},syncHash:function(){var a=this._hash;if(a!=document.location.hash){document.location.hash=a}return this},onHashChanged:function(){}}};